<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>完全平方数探索器 - Python版（带缩进）</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Comic Sans MS',cursive;}
body{background:linear-gradient(135deg,#89f7fe 0%,#66a6ff 100%);min-height:100vh;padding:20px;}
.container{max-width:1400px;margin:0 auto;display:flex;gap:30px;background:#fff;border-radius:25px;padding:30px;box-shadow:0 15px 35px rgba(0,0,0,.1);}
.left,.right{flex:1;background:#f7fafc;border-radius:20px;padding:25px;border:3px solid #a8d8ea;}
h1{text-align:center;color:#2d3748;margin-bottom:15px;font-size:2.2em;}
.code-box{background:#2d3748;color:#e2e8f0;border-radius:15px;padding:20px;font-size:16px;line-height:1.6;overflow-x:auto;white-space:pre;}
.line{padding:0;border-radius:3px;transition:all .3s;}
.highlight{background:#4ade80;color:#1a202c;}
.controls{display:flex;gap:15px;align-items:center;justify-content:center;margin:20px 0;flex-wrap:wrap;}
button{padding:10px 25px;font-size:18px;border:none;border-radius:25px;cursor:pointer;font-weight:bold;transition:.3s;box-shadow:0 4px 15px rgba(0,0,0,.2);}
.demo{background:linear-gradient(45deg,#ff6b6b,#ff8787);color:#fff;}
.reset{background:linear-gradient(45deg,#4ecdc4,#44a08d);color:#fff;}
button:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.3);}
.slider-box label{font-size:16px;font-weight:bold;color:#2d3748;}
.slider{width:200px;height:8px;border-radius:5px;background:#e2e8f0;outline:none;cursor:pointer;}
.canvas-area{position:relative;width:100%;height:420px;border:3px solid #e2e8f0;border-radius:15px;background:#fff;overflow:hidden;}
.grid{position:absolute;top:0;left:0;width:100%;height:100%;background-image:repeating-linear-gradient(0deg,#e5e7eb 0,#e5e7eb 1px,transparent 1px,transparent 20px),repeating-linear-gradient(90deg,#e5e7eb 0,#e5e7eb 1px,transparent 1px,transparent 20px);opacity:.3;}
canvas{position:absolute;top:0;left:0;}
.result-list{max-height:180px;overflow-y:auto;background:#fff;border:2px solid #e2e8f0;border-radius:15px;padding:15px;margin-top:15px;}
.result-item{background:linear-gradient(45deg,#c3f0ca,#11998e);color:#fff;padding:8px 15px;margin:4px 0;border-radius:20px;font-size:15px;animation:slide .5s;}
@keyframes slide{from{opacity:0;transform:translateX(-30px);}to{opacity:1;transform:translateX(0);}}
.status{font-size:20px;font-weight:bold;text-align:center;color:#2d3748;margin:10px 0;}
</style>
</head>
<body>
<div class="container">
  <div class="left">
    <h1>🔍 Python 代码区</h1>
    <pre class="code-box" id="codeBox">
<span class="line" id="L1">import math</span>
<span class="line" id="L2"></span>
<span class="line" id="L3">for i in range(1, 101):          # i 从 1~100 遍历</span>
<span class="line" id="L4">    root = math.sqrt(i)         # root 是 i 的平方根</span>
<span class="line" id="L5">    if int(root) == root:       # 如果 root 取整等于原值</span>
<span class="line" id="L6">        print(f"{i} 是完全平方数")  # 那么 i 是完全平方数</span>
    </pre>

    <div class="controls">
      <button class="demo" onclick="startDemo()">🐢 开始演示</button>
      <button class="reset" onclick="resetDemo()">🔄 重置</button>
      <div class="slider-box">
        <label>速度：</label>
        <input type="range" id="speedSlider" class="slider" min="50" max="2000" value="400">
      </div>
    </div>
    <div class="status" id="statusText">准备就绪！</div>
  </div>

  <div class="right">
    <h1>📐 可视化区</h1>
    <div class="canvas-area">
      <div class="grid"></div>
      <canvas id="sqCanvas" width="500" height="420"></canvas>
    </div>
    <div class="result-list" id="results"></div>
  </div>
</div>

<script>
const canvas  = document.getElementById('sqCanvas');
const ctx     = canvas.getContext('2d');
const results = document.getElementById('results');
const status  = document.getElementById('statusText');
const slider  = document.getElementById('speedSlider');
const lines   = document.querySelectorAll('.line');

let running = false;
let scale   = 20;   // 每单位格像素（正方形边长）
let delay   = 400;

slider.addEventListener('input', e => delay = parseInt(e.target.value));

function sleep(ms){return new Promise(r=>setTimeout(r,ms));}
function hl(n){lines.forEach(l=>l.classList.remove('highlight'));if(n)lines[n-1].classList.add('highlight');}

function drawSquare(side){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.beginPath();
  const s = side * scale;
  const x = (canvas.width  - s) / 2-8;
  const y = (canvas.height - s) / 2+4;
  ctx.strokeStyle='#11998e';
  ctx.lineWidth=4;
  ctx.rect(x,y,s,s);
  ctx.stroke();
  ctx.fillStyle='rgba(17,153,142,.15)';
  ctx.fill();

  ctx.fillStyle='#2d3748';
  ctx.font='bold 18px sans-serif';
  ctx.textAlign='center';
  ctx.fillText(`${side} × ${side}`, canvas.width/2, y + s + 25);
  ctx.fillText(`面积 = ${side*side}`, canvas.width/2, y - 10);
}

function addResult(n){
  const div=document.createElement('div');
  div.className='result-item';
  div.textContent=`${n} 是完全平方数 (${n} = ${Math.sqrt(n)}²)`;
  results.appendChild(div);
  results.scrollTop=results.scrollHeight;
}

async function startDemo(){
  if(running) return;
  running=true;
  resetDemo();
  hl(3);
  await sleep(delay);
  for(let i=1;i<=100;i++){
    hl(4);
    status.textContent=`正在检查 i = ${i}`;
    await sleep(delay*0.5);
    const root = Math.sqrt(i);
    hl(5);
    if(Number.isInteger(root)){
      hl(6);
      status.textContent=`🎉 发现：${i} 是完全平方数`;
      addResult(i);
      drawSquare(Math.floor(root));
      await sleep(delay*1.5);
    }
  }
  hl(6);
  status.textContent='✅ 探索完成！';
  running=false;
}

function resetDemo(){
  running=false;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  results.innerHTML='';
  hl();
  status.textContent='准备就绪！';
}

drawSquare(1);
</script>
</body>
</html>