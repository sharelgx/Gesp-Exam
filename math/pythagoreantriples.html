<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>勾股三元组探索器 2.0 - 小学编程教学</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Comic Sans MS',cursive;}
body{background:linear-gradient(135deg,#a1c4fd 0%,#c2e9fb 100%);min-height:100vh;padding:20px;}
.container{max-width:1400px;margin:0 auto;display:flex;gap:30px;background:#fff;border-radius:25px;padding:30px;box-shadow:0 15px 35px rgba(0,0,0,.1);}
.left,.right{flex:1;background:#f7fafc;border-radius:20px;padding:25px;border:3px solid #bee3f8;}
h1{text-align:center;color:#2d3748;margin-bottom:15px;font-size:2.2em;}
.code-box{background:#2d3748;color:#e2e8f0;border-radius:15px;padding:20px;font-size:16px;line-height:1.8;overflow-x:auto;}
.line{padding:2px 8px;border-radius:5px;transition:all .3s;}
.highlight{background:#4ade80;color:#1a202c;transform:scale(1.05);box-shadow:0 0 10px rgba(74,222,128,.6);}
.controls{display:flex;gap:15px;align-items:center;justify-content:center;margin:20px 0;flex-wrap:wrap;}
button{padding:10px 25px;font-size:18px;border:none;border-radius:25px;cursor:pointer;font-weight:bold;transition:.3s;box-shadow:0 4px 15px rgba(0,0,0,.2);}
.demo{background:linear-gradient(45deg,#ff6b6b,#ff8787);color:#fff;}
.reset{background:linear-gradient(45deg,#4ecdc4,#44a08d);color:#fff;}
button:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.3);}
.slider-box label{font-size:16px;font-weight:bold;color:#2d3748;}
.slider{width:200px;height:8px;border-radius:5px;background:#e2e8f0;outline:none;cursor:pointer;}
.canvas-area{position:relative;width:100%;height:420px;border:3px solid #e2e8f0;border-radius:15px;background:#fff;overflow:hidden;}
.grid{position:absolute;top:0;left:0;width:100%;height:100%;background-image:repeating-linear-gradient(0deg,#e5e7eb 0,#e5e7eb 1px,transparent 1px,transparent 20px),repeating-linear-gradient(90deg,#e5e7eb 0,#e5e7eb 1px,transparent 1px,transparent 20px);opacity:.3;}
canvas{position:absolute;top:0;left:0;}
.result-list{max-height:180px;overflow-y:auto;background:#fff;border:2px solid #e2e8f0;border-radius:15px;padding:15px;margin-top:15px;}
.result-item{background:linear-gradient(45deg,#ffd89b,#19547b);color:#fff;padding:8px 15px;margin:4px 0;border-radius:20px;font-size:15px;animation:slide .5s;}
@keyframes slide{from{opacity:0;transform:translateX(-30px);}to{opacity:1;transform:translateX(0);}}
.status{font-size:20px;font-weight:bold;text-align:center;color:#2d3748;margin:10px 0;}
</style>
</head>
<body>
<div class="container">
  <div class="left">
    <h1>🔍 代码区</h1>
    <div class="code-box" id="codeBox">
      <div class="line" id="L1">#include &lt;iostream&gt;</div>
      <div class="line" id="L2">#include &lt;cmath&gt;</div>
      <div class="line" id="L3">using namespace std;</div>
      <div class="line" id="L4"></div>
      <div class="line" id="L5">int main() {</div>
      <div class="line" id="L6">    for (int a = 1; a < 50; ++a) {</div>
      <div class="line" id="L7">        for (int b = a; b < 50; ++b) {</div>
      <div class="line" id="L8">            double c = sqrt(a * a + b * b);  // 计算斜边</div>
      <div class="line" id="L9">            if (c == (int)c) {  // 判断是否为整数</div>
      <div class="line" id="L10">                cout << a << "^2 + " << b << "^2 = " << (int)c << "^2" << endl;</div>
      <div class="line" id="L11">            }</div>
      <div class="line" id="L12">        }</div>
      <div class="line" id="L13">    }</div>
      <div class="line" id="L14">    return 0;</div>
      <div class="line" id="L15">}</div>
    </div>

    <div class="controls">
      <button class="demo" onclick="startDemo()">🐢 开始演示</button>
      <button class="reset" onclick="resetDemo()">🔄 重置</button>
      <div class="slider-box">
        <label>速度：</label>
        <input type="range" id="speedSlider" class="slider" min="50" max="2000" value="500">
      </div>
    </div>
    <div class="status" id="statusText">准备就绪！</div>
  </div>

  <div class="right">
    <h1>📐 可视化区</h1>
    <div class="canvas-area">
      <div class="grid"></div>
      <canvas id="triCanvas" width="500" height="420"></canvas>
    </div>
    <div class="result-list" id="results"></div>
  </div>
</div>

<script>
const canvas   = document.getElementById('triCanvas');
const ctx      = canvas.getContext('2d');
const results  = document.getElementById('results');
const status   = document.getElementById('statusText');
const slider   = document.getElementById('speedSlider');
const lines    = document.querySelectorAll('.line');

let running = false;
let scale   = 8;
let delay   = 500;

slider.addEventListener('input', e => delay = parseInt(e.target.value));

function sleep(ms){return new Promise(r=>setTimeout(r,ms));}
function hl(n){lines.forEach(l=>l.classList.remove('highlight'));if(n)lines[n-1].classList.add('highlight');}

function drawTriangle(a,b,c){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.beginPath();          // 防止路径残留
  const sx=30, sy=380;
  ctx.strokeStyle='#ff6b6b';
  ctx.lineWidth=4;
  ctx.moveTo(sx,sy);
  ctx.lineTo(sx+a*scale,sy);
  ctx.lineTo(sx,sy-b*scale);
  ctx.closePath();
  ctx.stroke();

  ctx.fillStyle='rgba(255,107,107,.15)';
  ctx.fill();

  ctx.fillStyle='#2d3748';
  ctx.font='bold 15px sans-serif';
  ctx.fillText(`a=${a}`,sx+a*scale/2-10,sy+20);
  ctx.fillText(`b=${b}`,sx-30,sy-b*scale/2);
  ctx.fillText(`c=${c}`,sx+a*scale/2-10,sy-b*scale/2-10);
  // 直角标记已删除，不再绘制
}

function addResult(a,b,c){
  const div=document.createElement('div');
  div.className='result-item';
  div.textContent=`${a}² + ${b}² = ${c}²`;
  results.appendChild(div);
  results.scrollTop=results.scrollHeight;
}

async function startDemo(){
  if(running) return;
  running=true;
  resetDemo();
  hl(6);
  await sleep(delay);
  for(let a=1;a<50;a++){
    hl(7);
    status.textContent=`a = ${a}`;
    await sleep(delay);
    for(let b=a;b<50;b++){
      hl(8);
      status.textContent=`a = ${a}, b = ${b}`;
      await sleep(delay*0.6);
      const c=Math.sqrt(a*a+b*b);
      if(Number.isInteger(c)){
        const intC=Math.floor(c);
        status.textContent=`🎉 发现：${a}² + ${b}² = ${intC}²`;
        addResult(a,b,intC);
        drawTriangle(a,b,intC);
        await sleep(delay*1.5);
      }
    }
  }
  hl(14);
  status.textContent='✅ 探索完成！';
  running=false;
}

function resetDemo(){
  running=false;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  results.innerHTML='';
  hl();
  status.textContent='准备就绪！';
}

drawTriangle(3,4,5);
</script>
</body>
</html>